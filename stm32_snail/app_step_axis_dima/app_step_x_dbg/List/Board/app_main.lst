###############################################################################
#
# IAR ANSI C/C++ Compiler V9.30.1.335/W64 for ARM         12/Mar/2023  14:29:51
# Copyright 1999-2022 IAR Systems AB.
#
#    Cpu mode                 =  thumb
#    Endian                   =  little
#    Source file              =
#        D:\proj\velograph\snail_w\stm32_snail\app_step_axis_dima\src\app_main.c
#    Command line             =
#        -f
#        D:\proj\velograph\snail_w\stm32_snail\app_step_axis_dima\app_step_x_dbg\Obj\Board\app_main.o.rsp
#        (D:\proj\velograph\snail_w\stm32_snail\app_step_axis_dima\src\app_main.c
#        -D VECT_TAB_FLASH -D IAR_ARM_CM3 -D DIMA_BRD -D STEP_X -D STM32F205xx
#        -lcN
#        D:\proj\velograph\snail_w\stm32_snail\app_step_axis_dima\app_step_x_dbg\List\Board
#        --diag_suppress Pa082,pe191 -o
#        D:\proj\velograph\snail_w\stm32_snail\app_step_axis_dima\app_step_x_dbg\Obj\Board
#        --no_cse --no_unroll --no_inline --no_code_motion --no_tbaa
#        --no_clustering --no_scheduling --debug --endian=little
#        --cpu=Cortex-M3 -e --fpu=None --dlib_config "C:\Program Files\IAR
#        Systems\Embedded Workbench 9.1\arm\inc\c\DLib_Config_Full.h" -I
#        D:\proj\velograph\snail_w\stm32_snail\app_step_axis_dima\.\ -I
#        D:\proj\velograph\snail_w\stm32_snail\app_step_axis_dima\src\board\ -I
#        D:\proj\velograph\snail_w\stm32_snail\app_step_axis_dima\..\common\freertos\source\inc\
#        -I D:\proj\velograph\snail_w\stm32_snail\app_step_axis_dima\src\inc\
#        -I
#        D:\proj\velograph\snail_w\stm32_snail\app_step_axis_dima\..\common\freertos\source\port\ARM_CM3\
#        -I
#        D:\proj\velograph\snail_w\stm32_snail\app_step_axis_dima\..\common\libraries\STM32F2xx_StdPeriph_Driver\inc\
#        -I
#        D:\proj\velograph\snail_w\stm32_snail\app_step_axis_dima\..\common\libraries\STM32F2xx_StdPeriph_Driver\
#        -I
#        D:\proj\velograph\snail_w\stm32_snail\app_step_axis_dima\..\common\dbg\
#        -I
#        D:\proj\velograph\snail_w\stm32_snail\app_step_axis_dima\..\common\usb\drv\inc\
#        -I
#        D:\proj\velograph\snail_w\stm32_snail\app_step_axis_dima\..\common\board\
#        -I
#        D:\proj\velograph\snail_w\stm32_snail\app_step_axis_dima\..\common\my_grbl\
#        -I
#        D:\proj\velograph\snail_w\stm32_snail\app_step_axis_dima\..\common\can\
#        -I
#        D:\proj\velograph\snail_w\stm32_snail\app_step_axis_dima\..\common\my_misc\
#        -I
#        D:\proj\velograph\snail_w\stm32_snail\app_step_axis_dima\..\common\libraries\eeprom_emul\
#        -On --use_c++_inline -I "C:\Program Files\IAR Systems\Embedded
#        Workbench 9.1\arm\CMSIS\Core\Include\\") --dependencies=n
#        D:\proj\velograph\snail_w\stm32_snail\app_step_axis_dima\app_step_x_dbg\Obj\Board\app_main.o.d
#    Locale                   =  C
#    List file                =
#        D:\proj\velograph\snail_w\stm32_snail\app_step_axis_dima\app_step_x_dbg\List\Board\app_main.lst
#    Object file              =
#        D:\proj\velograph\snail_w\stm32_snail\app_step_axis_dima\app_step_x_dbg\Obj\Board\app_main.o
#    Runtime model:              
#      __CPP_Runtime          =  1
#      __SystemLibrary        =  DLib
#      __dlib_file_descriptor =  1
#      __dlib_version         =  6
#
###############################################################################

D:\proj\velograph\snail_w\stm32_snail\app_step_axis_dima\src\app_main.c
      1          
      2          #include <stdio.h>
      3          
      4          #include "FreeRTOS.h"
      5          #include "task.h"
      6          #include "queue.h"
      7          
      8          /* Library includes. */
      9          ////#include "stm32f2xx_it.h"
     10          #include "stm32f2xx_rcc.h"
     11          
     12          /* Demo app includes. */
     13          #include "board.h"
     14          
     15          #include "misc.h"
     16          #include "printk.h"
     17          #include "emul_eeprom.h"
     18          ///=======================================================================
     19          ////extern void tst_task( void *pvParameters );
     20          extern void tst_task( void *pvParameters );
     21          extern void can_rsv_task( void *pvParameters );
     22          extern void can_send_thread(void* pp);
     23          
     24          extern void CAN1_Init (void);
     25          TaskHandle_t  can_send_thread_handle;
     26          
     27          ////============================================
     28          int main( void )
     29          {
     30          ////uint8_t btst=0; 
     31          ////uint32_t tst=0;
     32          uint16_t tmp=0;
     33          #ifdef DEBUG
     34            debug();
     35          #endif
     36          __disable_irq();
     37          hw_board_init();
     38          #if STEP_X
     39            printk("\n\r=== [app_step_x_axis] ==="); 
     40          #elif STEP_Y
     41            printk("\n\r=== [app_step_y_axis] ==="); 
     42          #elif STEP_Z
     43            printk("\n\r=== [app_step_z_axis] ==="); 
     44          #else 
     45            #error "\n\r=== app STEP_... nodefined ==="; 
     46          #endif
     47          ////=================================================
     48          eeprom_init();
     49          if(EE_ReadVariable(ADDR_EEPROM_BOOT_WORK, &tmp)==0)
     50            {
     51              if(tmp!=VAL_EEPROM_WORK) ///
     52                {
     53                 EE_WriteVariable(ADDR_EEPROM_BOOT_WORK, VAL_EEPROM_WORK);
     54                }
     55            }
     56          else
     57            {
     58            EE_WriteVariable(ADDR_EEPROM_BOOT_WORK, VAL_EEPROM_WORK);
     59            }
     60          ////=================================================
     61          CAN1_Init();
     62          ////goto_app();
     63          ////goto_booter();
     64          ////=================================================
     65          NVIC_PriorityGroupConfig( NVIC_PriorityGroup_4 );
     66          //// xTaskCreate( motor_task, "motor_task", MOTOR_TASK_STACK_SIZE, NULL, MOTOR_TASK_PRIORITY, NULL );
     67          xTaskCreate(can_send_thread, (const char*)"can_send_thread",CAN_SEND_STACK_SIZE/2, 0, APP_PRIORITY, &can_send_thread_handle);
     68          xTaskCreate( can_rsv_task, "can_rsv_task", CAN_TASK_STACK_SIZE, NULL, CAN_TASK_PRIORITY, NULL );
     69          xTaskCreate( tst_task, "tst_task", TST_TASK_STACK_SIZE, NULL, TST_TASK_PRIORITY, NULL );
     70          /* Start the scheduler. */
     71          vTaskStartScheduler();
     72          return 0;
     73          }
     74          
     75          #ifdef  DEBUG
     76          /* Keep the linker happy. */
     77          void assert_failed( unsigned char* pcFile, unsigned long ulLine )
     78          {
     79          	for( ;; )
     80          	{
     81          	}
     82          }
     83          #endif
     84          ////=======================================================
     85          
     86          ////=======================================================

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
      16   main
        16   -> CAN1_Init
        16   -> EE_ReadVariable
        16   -> EE_WriteVariable
        16   -> NVIC_PriorityGroupConfig
        16   -> _printk
        16   -> eeprom_init
        16   -> hw_board_init
        16   -> vTaskStartScheduler
        16   -> xTaskCreate


   Section sizes:

   Bytes  Function/Label
   -----  --------------
      28  ?_0
      16  ?_1
      16  ?_2
      12  ?_3
       4  can_send_thread_handle
     184  main

 
   4 bytes in section .bss
  72 bytes in section .rodata
 184 bytes in section .text
 
 184 bytes of CODE  memory
  72 bytes of CONST memory
   4 bytes of DATA  memory

Errors: none
Warnings: none
