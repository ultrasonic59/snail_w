###############################################################################
#
# IAR ANSI C/C++ Compiler V8.40.1.212/W32 for ARM         05/Dec/2020  20:45:05
# Copyright 1999-2019 IAR Systems AB.
#
#    Cpu mode     =  
#    Endian       =  little
#    Source file  =  D:\proj\velograph\snail\stm32_snail\common\usb\usbd_usr.c
#    Command line =
#        -f C:\Users\vova\AppData\Local\Temp\EWBDAA.tmp
#        (D:\proj\velograph\snail\stm32_snail\common\usb\usbd_usr.c -D
#        VECT_TAB_FLASH -D IAR_ARM_CM3 -D USEUSB -D MSTEP_BRD -D USE_USB_OTG_FS
#        -lcN D:\proj\velograph\snail\stm32_snail\mstep_usb\usb_can\List
#        --diag_suppress Pa082,pe191 -o
#        D:\proj\velograph\snail\stm32_snail\mstep_usb\usb_can\Obj --no_cse
#        --no_unroll --no_inline --no_code_motion --no_tbaa --no_clustering
#        --no_scheduling --debug --endian=little --cpu=Cortex-M3 -e --fpu=None
#        --dlib_config "C:\Program Files (x86)\IAR Systems\Embedded Workbench
#        8.3\arm\inc\c\DLib_Config_Full.h" -I
#        D:\proj\velograph\snail\stm32_snail\mstep_usb\.\ -I
#        D:\proj\velograph\snail\stm32_snail\mstep_usb\src\board\ -I
#        D:\proj\velograph\snail\stm32_snail\mstep_usb\..\common\freertos\source\inc\
#        -I D:\proj\velograph\snail\stm32_snail\mstep_usb\src\inc\ -I
#        D:\proj\velograph\snail\stm32_snail\mstep_usb\..\common\freertos\source\port\ARM_CM3\
#        -I
#        D:\proj\velograph\snail\stm32_snail\mstep_usb\..\common\libraries\inc\
#        -I D:\proj\velograph\snail\stm32_snail\mstep_usb\..\common\libraries\
#        -I D:\proj\velograph\snail\stm32_snail\mstep_usb\..\common\dbg\ -I
#        D:\proj\velograph\snail\stm32_snail\mstep_usb\..\common\libraries\STM32F2xx_StdPeriph_Driver\inc\
#        -I
#        D:\proj\velograph\snail\stm32_snail\mstep_usb\..\common\libraries\STM32F2xx_StdPeriph_Driver\
#        -I
#        D:\proj\velograph\snail\stm32_snail\mstep_usb\..\common\usb\core\inc\
#        -I
#        D:\proj\velograph\snail\stm32_snail\mstep_usb\..\common\usb\drv\inc\
#        -I D:\proj\velograph\snail\stm32_snail\mstep_usb\..\common\usb\ -I
#        D:\proj\velograph\snail\stm32_snail\mstep_usb\..\common\usb\inc\ -I
#        D:\proj\velograph\snail\stm32_snail\mstep_usb\..\common\hdlc\ -I
#        D:\proj\velograph\snail\stm32_snail\mstep_usb\..\common\usb\cdc\ -On
#        --use_c++_inline -I "C:\Program Files (x86)\IAR Systems\Embedded
#        Workbench 8.3\arm\CMSIS\Core\Include\" -I "C:\Program Files (x86)\IAR
#        Systems\Embedded Workbench 8.3\arm\CMSIS\DSP\Include\")
#    Locale       =  C
#    List file    =
#        D:\proj\velograph\snail\stm32_snail\mstep_usb\usb_can\List\usbd_usr.lst
#    Object file  =
#        D:\proj\velograph\snail\stm32_snail\mstep_usb\usb_can\Obj\usbd_usr.o
#
###############################################################################

D:\proj\velograph\snail\stm32_snail\common\usb\usbd_usr.c
      1          /**
      2            ******************************************************************************
      3            * @file    usbd_usr.c
      4            * @author  MCD Application Team
      5            * @version V1.2.0
      6            * @date    09-November-2015
      7            * @brief   This file includes the user application layer
      8            ******************************************************************************
      9            * @attention
     10            *
     11            * <h2><center>&copy; COPYRIGHT 2015 STMicroelectronics</center></h2>
     12            *
     13            * Licensed under MCD-ST Liberty SW License Agreement V2, (the "License");
     14            * You may not use this file except in compliance with the License.
     15            * You may obtain a copy of the License at:
     16            *
     17            *        http://www.st.com/software_license_agreement_liberty_v2
     18            *
     19            * Unless required by applicable law or agreed to in writing, software 
     20            * distributed under the License is distributed on an "AS IS" BASIS, 
     21            * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     22            * See the License for the specific language governing permissions and
     23            * limitations under the License.
     24            *
     25            ******************************************************************************
     26            */ 
     27          
     28          /* Includes ------------------------------------------------------------------*/
     29          
     30          #include "usbd_usr.h"
     31          
     32          /** @addtogroup STM32_USB_OTG_DEVICE_LIBRARY
     33          * @{
     34          */
     35          
     36          /** @defgroup USBD_USR 
     37          * @brief    This file includes the user application layer
     38          * @{
     39          */ 
     40          
     41          /** @defgroup USBD_USR_Private_TypesDefinitions
     42          * @{
     43          */ 
     44          /**
     45          * @}
     46          */ 
     47          
     48          
     49          /** @defgroup USBD_USR_Private_Defines
     50          * @{
     51          */ 
     52          /**
     53          * @}
     54          */ 
     55          
     56          
     57          /** @defgroup USBD_USR_Private_Macros
     58          * @{
     59          */ 
     60          /**
     61          * @}
     62          */ 
     63          
     64          
     65          /** @defgroup USBD_USR_Private_Variables
     66          * @{
     67          */ 
     68          
     69          USBD_Usr_cb_TypeDef USR_cb =
     70          {
     71            USBD_USR_Init,
     72            USBD_USR_DeviceReset,
     73            USBD_USR_DeviceConfigured,
     74            USBD_USR_DeviceSuspended,
     75            USBD_USR_DeviceResumed,
     76            
     77            USBD_USR_DeviceConnected,
     78            USBD_USR_DeviceDisconnected,  
     79           };
     80          ///=========================================
     81          #if 0
     82          #if (USB_CLASS==CUSTOMHID)
     83            #define USER_INFORMATION1      (uint8_t*)"[Key]:RemoteWakeup"
     84            #define USER_INFORMATION2      (uint8_t*)"[Joystick]:Mouse emulation"
     85          #elif (USB_CLASS==MSC)
     86            #define USER_INFORMATION1  (uint8_t*)"INFO : Single Lun configuration"
     87            #define USER_INFORMATION2  (uint8_t*)"INFO : microSD is used"
     88          #endif 
     89          
     90          #endif
     91          
     92          
     93          
     94          
     95          /**
     96          * @brief  USBD_USR_Init 
     97          *         Displays the message on LCD for host lib initialization
     98          * @param  None
     99          * @retval None
    100          */
    101          void USBD_USR_Init(void)
    102          {
    103          #if 0  
    104            /* Initialize LEDs */
    105            STM_EVAL_LEDInit(LED1);
    106            STM_EVAL_LEDInit(LED2);
    107            STM_EVAL_LEDInit(LED3);
    108            STM_EVAL_LEDInit(LED4);   
    109            
    110            /* Configure the IOE on which the JoyStick is connected */
    111          #if defined(USE_STM324x9I_EVAL)
    112            IOE16_Config();
    113          #else 
    114            IOE_Config();
    115          #endif
    116            
    117            /* Setup SysTick Timer for 1 msec interrupts 
    118            This interrupt is used to probe the joystick */
    119            if (SysTick_Config(SystemCoreClock / 1000))
    120            { 
    121              /* Capture error */ 
    122              while (1);
    123            } 
    124            /* Initialize the LCD */
    125          #if defined (USE_STM322xG_EVAL)
    126            STM322xG_LCD_Init();
    127          #elif defined(USE_STM324xG_EVAL)
    128            STM324xG_LCD_Init();
    129            
    130          #elif defined(USE_STM324x9I_EVAL)
    131            
    132            LCD_Init();
    133            LCD_LayerInit();
    134            
    135            /* Enable The Display */
    136            LCD_DisplayOn(); 
    137            /* Connect the Output Buffer to LCD Background Layer  */
    138            LCD_SetLayer(LCD_FOREGROUND_LAYER);
    139            
    140            /* Clear the Background Layer */ 
    141            LCD_Clear(LCD_COLOR_WHITE);
    142            
    143          #elif defined (USE_STM3210C_EVAL)
    144            STM3210C_LCD_Init();
    145          #else
    146           #error "Missing define: Evaluation board (ie. USE_STM322xG_EVAL)"
    147          #endif
    148          
    149            LCD_LOG_Init();
    150          
    151          #ifdef USE_USB_OTG_HS 
    152            LCD_LOG_SetHeader((uint8_t*)" OTG HS CDC-HID Device");
    153          #else
    154            LCD_LOG_SetHeader((uint8_t*)" OTG FS CDC-HID Device");
    155          #endif
    156            LCD_UsrLog("> USB device library started.\n"); 
    157            LCD_LOG_SetFooter ((uint8_t*)"     USB Device Library v1.2.0" );
    158            
    159            /* Information panel */
    160            LCD_SetTextColor(Green);
    161            LCD_DisplayStringLine( LCD_PIXEL_HEIGHT - 42, USER_INFORMATION1);
    162            LCD_DisplayStringLine( LCD_PIXEL_HEIGHT - 30, USER_INFORMATION2);
    163            LCD_SetTextColor(LCD_LOG_DEFAULT_COLOR);
    164          #endif  
    165          }
    166          
    167          /**
    168          * @brief  USBD_USR_DeviceReset 
    169          *         Displays the message on LCD on device Reset Event
    170          * @param  speed : device speed
    171          * @retval None
    172          */
    173          void USBD_USR_DeviceReset(uint8_t speed )
    174          {
    175           switch (speed)
    176           {
    177             case USB_OTG_SPEED_HIGH: 
    178            ///   LCD_LOG_SetFooter ((uint8_t*)"     USB Device Library v1.2.0 [HS]" );
    179               break;
    180          
    181            case USB_OTG_SPEED_FULL: 
    182            ///   LCD_LOG_SetFooter ((uint8_t*)"     USB Device Library v1.2.0 [FS]" );
    183               break;
    184           default:
    185           ///    LCD_LOG_SetFooter ((uint8_t*)"     USB Device Library v1.2.0 [??]" );
    186               break;
    187              
    188           }
    189          }
    190          
    191          
    192          /**
    193          * @brief  USBD_USR_DeviceConfigured
    194          *         Displays the message on LCD on device configuration Event
    195          * @param  None
    196          * @retval Status
    197          */
    198          void USBD_USR_DeviceConfigured (void)
    199          {
    200          ////  LCD_UsrLog("> HID Interface started.\n");
    201          ///  LCD_UsrLog("> CDC Interface started.\n");
    202          }
    203          
    204          
    205          /**
    206          * @brief  USBD_USR_DeviceConnected
    207          *         Displays the message on LCD on device connection Event
    208          * @param  None
    209          * @retval Status
    210          */
    211          void USBD_USR_DeviceConnected (void)
    212          {
    213           //// LCD_UsrLog("> USB Device Connected.\n");
    214          }
    215          
    216          
    217          /**
    218          * @brief  USBD_USR_DeviceDisonnected
    219          *         Displays the message on LCD on device disconnection Event
    220          * @param  None
    221          * @retval Status
    222          */
    223          void USBD_USR_DeviceDisconnected (void)
    224          {
    225          ////  LCD_UsrLog("> USB Device Disconnected.\n");
    226          }
    227          
    228          /**
    229          * @brief  USBD_USR_DeviceSuspended 
    230          *         Displays the message on LCD on device suspend Event
    231          * @param  None
    232          * @retval None
    233          */
    234          void USBD_USR_DeviceSuspended(void)
    235          {
    236           //// LCD_UsrLog("> USB Device in Suspend Mode.\n");
    237            /* Users can do their application actions here for the USB-Reset */
    238          }
    239          
    240          
    241          /**
    242          * @brief  USBD_USR_DeviceResumed 
    243          *         Displays the message on LCD on device resume Event
    244          * @param  None
    245          * @retval None
    246          */
    247          void USBD_USR_DeviceResumed(void)
    248          {
    249            ///  LCD_UsrLog("> USB Device in Idle Mode.\n");
    250            /* Users can do their application actions here for the USB-Reset */
    251          }
    252          
    253          
    254          /************************ (C) COPYRIGHT STMicroelectronics *****END OF FILE****/

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
       0   USBD_USR_DeviceConfigured
       0   USBD_USR_DeviceConnected
       0   USBD_USR_DeviceDisconnected
       0   USBD_USR_DeviceReset
       0   USBD_USR_DeviceResumed
       0   USBD_USR_DeviceSuspended
       0   USBD_USR_Init


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       2  USBD_USR_DeviceConfigured
       2  USBD_USR_DeviceConnected
       2  USBD_USR_DeviceDisconnected
      20  USBD_USR_DeviceReset
       2  USBD_USR_DeviceResumed
       2  USBD_USR_DeviceSuspended
       2  USBD_USR_Init
      28  USR_cb

 
 28 bytes in section .data
 32 bytes in section .text
 
 32 bytes of CODE memory
 28 bytes of DATA memory

Errors: none
Warnings: none
